
-- unite-and-conquer (exclusive) scan
-- only for a sequence with length of power of 2
function uc_scan2(v:{int}) : {int} =  
   let is = scanExPlus({1 : x in v})
    in if reducePlus(is) == 0 then {0} else 
         let odds = concat({{x|i%2==0} :  i in is, x in v});
             evens = concat({{x|not(i%2 == 0)} : i in is, x in v});
             ps = {x+y : x in odds, y in evens}
          in concat({{s,s+x} : s in uc_scan2(ps), x in odds})
	   